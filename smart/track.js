function Track(game, details) {
  details = details || {};
  this.scale = details.scale || 50;
  var bodyDef = new b2BodyDef();
  bodyDef.type = b2Body.b2_staticBody;
  bodyDef.position = new b2Vec2(details.x || 0, details.y || 0);
  this.body = game.world.CreateBody(bodyDef);
  this.body.SetUserData(this);

  var fixtureDef = new b2FixtureDef();
  fixtureDef.shape = new b2PolygonShape();
  for(var p=0; p<Track.edges.length; p++) {
    for(var i=1; i<Track.edges[p].x.length; i++) {
      fixtureDef.shape.SetAsEdge(
        new b2Vec2(Track.edges[p].x[i-1] * this.scale, Track.edges[p].y[i-1] * this.scale),
        new b2Vec2(Track.edges[p].x[i] * this.scale, Track.edges[p].y[i]     * this.scale) 
      );
      this.body.CreateFixture(fixtureDef);
    }
  }
}    
Track.prototype.draw = function(context) {
    var pos = this.body.GetPosition(),
        angle = this.body.GetAngle();

    context.save();
    context.translate(pos.x, pos.y);
    context.rotate(angle);

    context.strokeStyle = "green";
    for(var p=0; p<Track.edges.length; p++) {
      context.beginPath();
      context.moveTo(Track.edges[p].x[0] * this.scale, Track.edges[p].y[0] * this.scale);
      for(var i=1; i<Track.edges[p].x.length; i++) {
        context.lineTo(Track.edges[p].x[i] * this.scale, Track.edges[p].y[i] * this.scale) ;
      }
      context.closePath();
      context.stroke();
    }

    context.strokeStyle = "orange";
    for(var i=0; i<Track.waypoints.length; i++) {
      var wp = Track.waypoints[i].p,
          wn = Track.waypoints[i].n;
      context.beginPath();
      context.arc(wp.x,wp.y, 1, 0, Math.PI*2);
      context.closePath()
      context.fill();
      context.moveTo(wp.x, wp.y);
      context.lineTo(wp.x+wn.x*5, wp.y+wn.y*5);
      context.stroke();
//      context.fillText("#"+i, Track.checkpoints[i].x[0] * 50,Track.checkpoints[i].y[0] * 50);
    }

    context.restore();
}
Track.waypoints = [{"p":{"x":-102.11812853813169,"y":112.63866722583771},"n":{"x":-0.8917629941694708,"y":-0.4525027759361264}},{"p":{"x":-30.140873789787292,"y":131.51270151138309},"n":{"x":-0.9983831013951494,"y":-0.0568434943384281}},{"p":{"x":31.91947191953659,"y":126.07442140579221},"n":{"x":-0.9648340943344842,"y":0.26285960208779824}},{"p":{"x":82.14359283447268,"y":106.56059980392456},"n":{"x":-0.9998814397402664,"y":0.015398261685391003}},{"p":{"x":132.68766403198242,"y":118.39685440063477},"n":{"x":-0.9653080671702035,"y":0.2611136447145683}},{"p":{"x":158.59944820404053,"y":77.76971459388733},"n":{"x":-0.11974183754645462,"y":0.9928050626084651}},{"p":{"x":150.28204321861267,"y":37.46246695518493},"n":{"x":0.6186476773284478,"y":0.7856685378301188}},{"p":{"x":86.62217259407042,"y":8.671589195728302},"n":{"x":0.9113984852103851,"y":0.4115249702705966}},{"p":{"x":55.65597265958786,"y":-30.100169777870178},"n":{"x":-0.021238773124984296,"y":0.9997744318175703}},{"p":{"x":95.32346427440645,"y":-74.88603591918948},"n":{"x":-0.5676163058495096,"y":0.8232932219651491}},{"p":{"x":105.4472267627716,"y":-132.8675925731659},"n":{"x":0.47725651440545996,"y":0.8787640294513372}},{"p":{"x":48.69279116392137,"y":-163.54565024375916},"n":{"x":0.9671616175776349,"y":0.2541621637549792}},{"p":{"x":-31.376993656158447,"y":-156.48970007896423},"n":{"x":0.9553078267403915,"y":-0.29561284844970803}},{"p":{"x":-91.81282222270966,"y":-116.914963722229},"n":{"x":0.33957460956100677,"y":-0.9405791218932565}},{"p":{"x":-65.12289941310883,"y":-64.14874792098996},"n":{"x":-0.5953557425698669,"y":-0.8034622205113833}},{"p":{"x":-54.11088913679123,"y":-28.27095240354538},"n":{"x":0.2151337441211908,"y":-0.9765845954859199}},{"p":{"x":-102.0663321018219,"y":5.830696225166323},"n":{"x":0.808928940548716,"y":-0.5879064289006646}},{"p":{"x":-136.52321100234985,"y":38.15619945526123},"n":{"x":0.35388314652327313,"y":-0.9352896442315545}},{"p":{"x":-135.45753359794617,"y":80.42802810668945},"n":{"x":-0.3727573720092644,"y":-0.9279288451237772}}];

Track.edges = [];
Track.edges[0] = {
  x: [
    -0.9097104072570801, 
    -1.330470561981201,
    -1.922931194305420,
    -2.276868820190430,
    -2.469225883483887,
    -2.43075418472290,
    -2.284563064575195,
    -1.822905063629150,
    -1.368941783905029,
    -0.7918696403503418,
    -0.03782844543457031,
    0.2699427604675293,
    0.4468836784362793,
    0.7316012382507324,
    1.197548866271973,
    1.452444076538086,
    1.821600914001465,
    2.067707061767578,
    2.278654098510742,
    2.436864852905273,
    2.542337417602539,
    2.647811889648438,
    2.691759109497070,
    2.700548171997070,
    2.674180030822754,
    2.568705558776855,
    2.331390380859375,
    1.883128166198730,
    1.417284965515137,
    0.9338645935058594,
    0.6701812744140625,
    0.5734958648681641,
    0.5471277236938477,
    0.6877593994140625,
    1.012969970703125,
    1.285443305969238,
    1.601863861083984,
    1.768864631652832,
    1.760074615478516,
    1.593074798583984,
    1.303022384643555,
    0.8723382949829102,
    0.3449707031250,
    -0.1823978424072266,
    -0.7097673416137695,
    -1.193187236785889,
    -1.368977069854736,
    -1.333818912506104,
    -1.158029556274414,
    -0.964660644531250,
    -0.6306610107421875,
    -0.5691347122192383,
    -0.6306610107421875,
    -0.9097104072570801
  ],
  y: [
    -0.06152632087469101,
    0.1226348876953125,
    0.3611578941345215,
    0.6997075080871582,
    1.045950412750244,
    1.415276527404785,
    1.761519908905029,
    2.023125648498535,
    2.169317722320557,
    2.230871677398682,
    2.238565921783447,
    2.192400455474854,
    2.104478359222412,
    2.053903102874756,
    1.757134914398193,
    1.686819076538086,
    1.669239997863770,
    1.713187217712402,
    1.862607955932617,
    1.941713809967041,
    1.906555652618408,
    1.757134914398193,
    1.519819259643555,
    1.220976829528809,
    1.027608871459961,
    0.9045557975769043,
    0.7990822792053223,
    0.6672401428222656,
    0.5266089439392090,
    0.1926088333129883,
    -0.1413908004760742,
    -0.4138650894165039,
    -0.730285644531250,
    -1.055496215820312,
    -1.284022331237793,
    -1.389496326446533,
    -1.644390583038330,
    -1.987179994583130,
    -2.356337785720825,
    -2.558495998382568,
    -2.830969333648682,
    -2.892495870590210,
    -2.954021930694580,
    -2.874916791915894,
    -2.760653495788574,
    -2.417864322662354,
    -2.198127508163452,
    -1.899285316467285,
    -1.635601043701172,
    -1.354338645935059,
    -0.9412331581115723,
    -0.6160225868225098,
    -0.3347592353820801,
    -0.06152632087469101
  ]
};
Track.edges[1] = {
"x" : 
              [
                -3.164209604263306,
                -3.144450187683105,
                -3.003818511962891,
                -2.871976375579834,
                -2.590713024139404,
                -2.186397552490234,
                -1.527187347412109,
                -1.140450477600098,
                -0.4197139739990234,
                0.5031805038452148,
                0.9778118133544922,
                1.153601646423340,
                1.540338516235352,
                1.812810897827148,
                2.041338920593262,
                2.313811302185059,
                2.779653549194336,
                3.069705963134766,
                3.359758377075195,
                3.544337272644043,
                3.614653587341309,
                3.570705413818359,
                3.368547439575195,
                3.078495979309082,
                2.498390197753906,
                1.891917228698730,
                1.680970191955566,
                1.610653877258301,
                1.689759254455566,
                1.971021652221680,
                2.357758522033691,
                2.630232810974121,
                2.674180030822754,
                2.515969276428223,
                2.234706878662109,
                1.847970008850098,
                1.153601646423340,
                0.3186016082763672,
                -0.4724502563476562,
                -1.017397880554199,
                -1.57113504409790,
                -1.957871437072754,
                -2.283082008361816,
                -2.397345066070557,
                -2.406134128570557,
                -2.300660610198975,
                -2.045766353607178,
                -1.790871620178223,
                -1.518397808074951,
                -1.474450588226318,
                -1.632660865783691,
                -2.001818656921387,
                -2.432503223419189,
                -2.775292396545410,
                -2.959871292114258,
                -3.100502967834473,
                -3.164209604263306
              ],
              "y" : 
              [
                1.001999855041504,
                1.387976646423340,
                1.792292118072510,
                2.117502689361572,
                2.363607883453369,
                2.600924015045166,
                2.908555507659912,
                3.022818088531494,
                3.057976245880127,
                3.031608104705811,
                2.864608287811279,
                2.706397533416748,
                2.600924015045166,
                2.600924015045166,
                2.776712894439697,
                2.855818271636963,
                2.811871051788330,
                2.662450313568115,
                2.460292339324951,
                2.214187145233154,
                1.748345375061035,
                1.089134693145752,
                0.6320819854736328,
                0.3596081733703613,
                0.08713531494140625,
                -0.1589698791503906,
                -0.3699173927307129,
                -0.6160225868225098,
                -0.8357591629028320,
                -1.037917137145996,
                -1.442233085632324,
                -1.899285316467285,
                -2.417864322662354,
                -2.918864250183105,
                -3.191337823867798,
                -3.455021858215332,
                -3.595653533935547,
                -3.639600753784180,
                -3.542916536331177,
                -3.375916719436646,
                -3.164969205856323,
                -2.971600770950317,
                -2.681548595428467,
                -2.435443401336670,
                -2.136601209640503,
                -1.811390876770020,
                -1.477390766143799,
                -1.292811870574951,
                -0.9500226974487305,
                -0.7478647232055664,
                -0.5281281471252441,
                -0.3699173927307129,
                -0.1150231361389160,
                0.2365560531616211,
                0.4826612472534180,
                0.7639245986938477,
                1.001999855041504
              ]
}
