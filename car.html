<html>
   <head>
      <title>Box2dWeb example</title>
      <style type="text/css">
      canvas { -webkit-transform: translateZ(0); }
      </style>
   </head>
   <body>
      <canvas id="canvas" width="1200" height="700"></canvas>
   </body>
   <script type="text/javascript" src="lib/Box2dWeb-2.1.a.3.min.js"></script>
   <script type="text/javascript" src="lib/patch.js"></script>
   <script type="text/javascript" src="game.js"></script>
   <script type="text/javascript" src="keyboard.js"></script>
   <script type="text/javascript" src="body.js"></script>
   <script type="text/javascript" src="car.js"></script>
   <script type="text/javascript" src="tire.js"></script>
   <script type="text/javascript" src="track.js"></script>
   <script type="text/javascript" src="trackData.js"></script>
   <script type="text/javascript">

      var game,
          car,
          lastFrame = new Date().getTime();
       
      window.keyboard = new Keyboard();

      function gameLoop() {
         var tm = new Date().getTime();
         var dt = (tm - lastFrame) / 1000;
         if(dt > 1/15) { dt = 1/15; }
         game.step(dt);
         lastFrame = tm;
         requestAnimationFrame(gameLoop);
      };
       
      function init() {
          game = new Game(document.getElementById("canvas"), 8, new b2Vec2(0,0));
            //game.debug();
          new Track(game, { fixtures: track.body[0].fixture, x: 280, y: 150 });

          //game.camera = 
          car = new Car(game, { x: 80, y: 160 });
          game.camera = {
            body: { 
              GetPosition: function() { 
                return { x: 260, y: 160 }; 
              }
            }
          };
          game.camera = car;

          requestAnimationFrame(gameLoop);
      }
       
      window.addEventListener("load",init);

function loadRUBE(game, item) {
  var bodyDef = new b2BodyDef();
  bodyDef.type = b2Body.b2_staticBody;
  var body = game.world.CreateBody(bodyDef);
  fixtures = item.body[0].fixture;
  for(var i=0; i<fixtures.length;i++) {
    var fixtureDef = new b2FixtureDef();
    fixtureDef.density = 2;
    fixtureDef.friction = 1;
    fixtureDef.restitution = 0.2;
    fixtureDef.shape = new b2PolygonShape();
    var polygon = fixtures[i].polygon.vertices;
    var vertices = [];
    for(var j=0; j<polygon.x.length; j++) {
      var vec = new b2Vec2(polygon.x[j],polygon.y[j]);
      vec.Multiply(40);
      vec.Add(new b2Vec2(20,20));
      vertices.push(vec);
    }
    fixtureDef.shape.SetAsArray(vertices, vertices.length);
    body.CreateFixture(fixtureDef);
  }
  return body;
}
   </script>
   
   
</html>